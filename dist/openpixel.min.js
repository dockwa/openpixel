// Open Pixel v1.1.0 | Published By Dockwa | Created By Stuart Yamartino | MIT License
!function(r,u,i,e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}var l={id:"",version:1},f=function(){function t(){a(this,t)}return c(t,null,[{key:"isPresent",value:function(e){return null!=e&&""!==e}},{key:"now",value:function(){return 1*new Date}},{key:"guid",value:function(){return l.version+"-xxxxxxxx-".replace(/[x]/g,function(e){var t=36*Math.random()|0;return("x"==e?t:3&t|8).toString(36)})+(1*new Date).toString(36)}},{key:"optionalData",value:function(e){return!1===t.isPresent(e)?"":"object"===o(e)?t.optionalData(JSON.stringify(e)):"function"==typeof e?t.optionalData(e()):String(e)}}]),t}(),m=function(){function e(){a(this,e)}return c(e,null,[{key:"nameAndVersion",value:function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===n[1]&&null!=(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))}},{key:"isMobile",value:function(){return"ontouchstart"in u}},{key:"userAgent",value:function(){return r.navigator.userAgent}}]),e}(),g=function(){function e(){a(this,e)}return c(e,null,[{key:"prefix",value:function(){return"__opix_"}},{key:"set",value:function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"/",r="";if(f.isPresent(n)){var o=new Date;o.setTime(o.getTime()+60*n*1e3),r="; expires="+o.toGMTString()}u.cookie=this.prefix()+e+"="+t+r+"; path="+i+"; SameSite=Lax"}},{key:"get",value:function(e){e=this.prefix()+e+"=";for(var t=u.cookie.split(";"),n=0;n<t.length;n++){for(var i=t[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}}},{key:"delete",value:function(e){this.set(e,"",-100)}},{key:"exists",value:function(e){return f.isPresent(this.get(e))}},{key:"setUtms",value:function(){for(var e=["utm_source","utm_medium","utm_term","utm_content","utm_campaign"],t=!1,n=0,i=e.length;n<i;n++)if(f.isPresent(h.getParameterByName(e[n]))){t=!0;break}if(t){var r,o={};for(n=0,i=e.length;n<i;n++)r=h.getParameterByName(e[n]),f.isPresent(r)&&(o[e[n]]=r);this.set("utm",JSON.stringify(o))}}},{key:"getUtm",value:function(e){if(this.exists("utm")){var t=JSON.parse(this.get("utm"));return e in t?t[e]:""}}}]),e}(),h=function(){function e(){a(this,e)}return c(e,null,[{key:"getParameterByName",value:function(e,t){t||(t=r.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}},{key:"externalHost",value:function(e){return e.hostname!=location.hostname&&0===e.protocol.indexOf("http")}}]),e}(),p=function(){function i(e,t,n){a(this,i),this.params=[],this.event=e,this.timestamp=t,this.optional=f.optionalData(n),this.buildParams(),this.send()}return c(i,[{key:"buildParams",value:function(){var e=this.getAttribute();for(var t in e)e.hasOwnProperty(t)&&this.setParam(t,e[t](t))}},{key:"getAttribute",value:function(){var e=this;return{id:function(){return l.id},uid:function(){return g.get("uid")},ev:function(){return e.event},ed:function(){return e.optional},v:function(){return l.version},dl:function(){return r.location.href},rl:function(){return u.referrer},ts:function(){return e.timestamp},de:function(){return u.characterSet},sr:function(){return r.screen.width+"x"+r.screen.height},vp:function(){return r.innerWidth+"x"+r.innerHeight},cd:function(){return r.screen.colorDepth},dt:function(){return u.title},bn:function(){return m.nameAndVersion()},md:function(){return m.isMobile()},ua:function(){return m.userAgent()},tz:function(){return(new Date).getTimezoneOffset()},utm_source:function(e){return g.getUtm(e)},utm_medium:function(e){return g.getUtm(e)},utm_term:function(e){return g.getUtm(e)},utm_content:function(e){return g.getUtm(e)},utm_campaign:function(e){return g.getUtm(e)}}}},{key:"setParam",value:function(e,t){f.isPresent(t)?this.params.push("".concat(e,"=").concat(encodeURIComponent(t))):this.params.push("".concat(e,"="))}},{key:"send",value:function(){r.navigator.sendBeacon?this.sendBeacon():this.sendImage()}},{key:"sendBeacon",value:function(){r.navigator.sendBeacon(this.getSourceUrl())}},{key:"sendImage",value:function(){this.img=u.createElement("img"),this.img.src=this.getSourceUrl(),this.img.style.display="none",this.img.width="1",this.img.height="1",u.getElementsByTagName("body")[0].appendChild(this.img)}},{key:"getSourceUrl",value:function(){return"".concat("https://tracker.example.com/pixel.gif","?").concat(this.params.join("&"))}}]),i}();g.exists("uid")?g.set("uid",g.get("uid"),1051200):g.set("uid",f.guid(),1051200),g.setUtms(),i.process=function(e,t,n){"init"==e?l.id=t:"event"==e&&("pageload"!=t||l.pageLoadOnce?"pageload"!=t&&"pageclose"!=t&&new p(t,f.now(),n):(l.pageLoadOnce=!0,new p(t,i.t,n)))};for(var d=0,v=i.queue.length;d<v;d++)i.process.apply(i,i.queue[d]);r.addEventListener("beforeunload",function(){l.pageCloseOnce||(l.pageCloseOnce=!0,new p("pageclose",f.now(),function(){if(f.isPresent(l.externalHost)&&f.now()-l.externalHost.time<5e3)return l.externalHost.link}))}),r.onload=function(){for(var e=u.getElementsByTagName("a"),t=0,n=e.length;t<n;t++)e[t].addEventListener("click",function(e){h.externalHost(this)&&(l.externalHost={link:this.href,time:f.now()})}.bind(e[t]))}}(window,document,window.opix);
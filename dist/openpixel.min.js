// Open Pixel v1.0.0 | Published By Dockwa | Created By Stuart Yamartino | MIT License
!function(e,t,n,r,i,o){"use strict";function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c={id:"",version:o},f=function(e){return"undefined"!=typeof e&&null!==e&&""!==e},m=function(){return 1*new Date},l=function(){return c.version+"-xxxxxxxx-".replace(/[x]/g,function(e){var t=36*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(36)})+(1*new Date).toString(36)},g=function b(e){return f(e)===!1?"":"object"===("undefined"==typeof e?"undefined":s(e))?b(JSON.stringify(e)):"function"==typeof e?b(e()):String(e)},d={nameAndVersion:function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"IE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\b(OPR|Edge)\/(\d+)/),null!=e)?e.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))},isMobile:function(){return"ontouchstart"in t},userAgent:function(){return e.navigator.userAgent}},h={prefix:function(){return"__"+r+"_"},set:function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",o="";if(f(r)){var u=new Date;u.setTime(u.getTime()+60*r*1e3),o="; expires="+u.toGMTString()}t.cookie=this.prefix()+e+"="+n+o+"; path="+i},get:function(e){for(var e=this.prefix()+e+"=",n=t.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}},"delete":function(e){this.set(e,"",-100)},exists:function(e){return f(this.get(e))},setUtms:function(){for(var e=["utm_source","utm_medium","utm_term","utm_content","utm_campaign"],t=!1,n=0,r=e.length;n<r;n++)if(f(p.getParameterByName(e[n]))){t=!0;break}if(t){for(var i,o={},n=0,r=e.length;n<r;n++)i=p.getParameterByName(e[n]),f(i)&&(o[e[n]]=i);this.set("utm",JSON.stringify(o))}},getUtm:function(e){if(this.exists("utm")){var t=JSON.parse(this.get("utm"));return e in t?t[e]:""}}},p={getParameterByName:function(t,n){n||(n=e.location.href),t=t.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)","i"),i=r.exec(n);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},externalHost:function(e){return e.hostname!=location.hostname&&0===e.protocol.indexOf("http")}},v=function(){function n(e,t,r){u(this,n),this.params=[],this.event=e,this.timestamp=t,this.optinal=g(r),this.buildParams(),this.send()}return a(n,[{key:"buildParams",value:function(){var e=this.getAttribute();for(var t in e)e.hasOwnProperty(t)&&this.setParam(t,e[t](t))}},{key:"getAttribute",value:function(){var n=this;return{id:function(){return c.id},uid:function(){return h.get("uid")},ev:function(){return n.event},ed:function(){return n.optinal},v:function(){return c.version},dl:function(){return e.location.href},rl:function(){return t.referrer},ts:function(){return n.timestamp},de:function(){return t.characterSet},sr:function(){return e.screen.width+"x"+e.screen.height},vp:function(){return e.innerWidth+"x"+e.innerHeight},cd:function(){return e.screen.colorDepth},dt:function(){return t.title},bn:function(){return d.nameAndVersion()},md:function(){return d.isMobile()},ua:function(){return d.userAgent()},utm_source:function(e){return h.getUtm(e)},utm_medium:function(e){return h.getUtm(e)},utm_term:function(e){return h.getUtm(e)},utm_content:function(e){return h.getUtm(e)},utm_campaign:function(e){return h.getUtm(e)}}}},{key:"setParam",value:function(e,t){f(t)?this.params.push(e+"="+t):this.params.push(e+"=")}},{key:"send",value:function(){e.navigator.sendBeacon?this.sendBeacon():this.sendImage()}},{key:"sendBeacon",value:function(){e.navigator.sendBeacon(this.getSourceUrl())}},{key:"sendImage",value:function(){this.img=t.createElement("img"),this.img.src=this.getSourceUrl(),this.img.style.display="none",this.img.width="1",this.img.height="1",t.getElementsByTagName("body")[0].appendChild(this.img)}},{key:"getSourceUrl",value:function(){return i+"?"+encodeURI(this.params.join("&"))}}]),n}();h.exists("uid")?h.set("uid",h.get("uid"),1051200):h.set("uid",l(),1051200),h.setUtms(),n.process=function(e,t,r){"init"==e?c.id=t:"event"==e&&("pageload"!=t||c.pageLoadOnce?"pageload"!=t&&"pageclose"!=t&&new v(t,m(),r):(c.pageLoadOnce=!0,new v(t,n.t,r)))};for(var y=0,x=n.queue.length;y<x;y++)n.process.apply(n,n.queue[y]);e.addEventListener("unload",function(){c.pageCloseOnce||(c.pageCloseOnce=!0,new v("pageclose",m(),function(){if(f(c.externalHost)&&m()-c.externalHost.time<5e3)return c.externalHost.link}))}),e.onload=function(){for(var e=t.getElementsByTagName("a"),n=0,r=e.length;n<r;n++)e[n].addEventListener("click",function(e){p.externalHost(this)&&(c.externalHost={link:this.href,time:m()})}.bind(e[n]))}}(window,document,window.opix,"opix","https://tracker.example.com/pixel.gif",1);